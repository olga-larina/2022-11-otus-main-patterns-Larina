# Домашнее задание № 08
Системы обмена сообщениями

## Цель:
Применить навыки построения архитектуры, основанной на системе обмена сообщениями.
Написать Endpoint для приема входящих сообщений Игровым сервером.

## Описание/Пошаговая инструкция выполнения домашнего задания:
Задача Endpoint - принять входящее сообщение от Агента, десериализовать его и передать его на обработку внутрь игрового сервера.
Необходимо определить, какому из танковых боев это сообщение было адресовано (маршрутизация), и уведомить его о входящем сообщении 
(т.е. передать сообщение в обработку).

### Описание задания:
1. Определить формат сообщений, которые отправляет Агент игровому серверу.
Указание: правила во всех играх могут сильно отличаться друг от друга, поэтому нужно подумать о таком формате, 
который бы не зависел от текущей реализации конкретных команд, то есть чтобы endpoint не приходилось модифицировать каждый раз, 
когда мы разработаем новое правило игры. 
Как идею для решения поставленной задачи можно рассмотреть следующий набор данных, который стоит передавать в сообщении:
id игры - для идентификации игры, в рамках которой это сообщение обработано. С помощью этого id можно будет определить получателя сообщения при маршрутизации сообщения внутри игрового сервера.
id игрового объекта, которому адресовано сообщение. С помощью этого id можно будет определить игровой объект внутри игры, для которого адресовано это сообщение.
id операции - по этому id в IoC можно будет определить команду, которая будет обрабатывать данное сообщение.
args - вложенный json объект с параметрами операции. Содержимое этого объекта полностью зависит от команды, которая будет применяться к игровому объекту.
2. Определить endpoint, который принимает входящее сообщение и конвертирует в команду InterpretCommand.
endpoint должен определить игру, которой адресовано сообщение, создать команду InterpretCommand и поместить эту команду в очередь команд этой игры.
Команда InterpretCommand получает всю информацию об операции, которую необходимо выполнить, параметрах и объекте, над которым эта операция будет выполняться.
3. Задача команды InetrpretCommand - на основе IoC контейнера создать команду для нужного объекта, которая соответствует приказу, 
содержащемуся в сообщении, и поставить эту команду в очередь команд игры.
Например, если сообщение указано, что объект с id 548 должен начать двигаться, то результат InterpretCommand заключается можно описать следующим псевдокодом
```code
var obj = IoC.Resolve("Игровые объекты", "548"); // "548" получено из входящего сообщения
IoC.Resolve("Установить начальное значение скорости", obj, 2); // значение 2 получено из args переданного в сообщении
var cmd = IoC.Resolve("Движение по прямой", obj); // Решение, что нужно выполнить движение по прямой получено из сообщения
// обратите внимание само значение "Движение по прямой" нельзя читать на прямую из сообщения,
// чтобы избежать инъекции, когда пользователь попытается выполнить действие, которое ему выполнять не позволено
IoC.Resolve("Очередь команд", cmd).Execute(); // Выполняем команду, которая поместит команду cmd в очередь команд игры.
```
